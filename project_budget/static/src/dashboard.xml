<?xml version="1.0" encoding="UTF-8" ?>
<templates xml:space="preserve">

<t t-name="project_budget.clientaction" owl="1">
    <div class="row">
        <div class="col m-0 p-0">
            <div class="shadow-sm border m-2 p-4 bg-white">
                <div class="d-flex align-items-center justify-content-between">
                    <h1 class="text-primary fw-bold">Project Budget Dashboard</h1>
                </div>
            </div>
        </div>
    </div>
    <Layout display="display">
        <t t-set-slot="control-panel-bottom-left">
            <button class="btn btn-primary" t-on-click="openCustomerView"> Customers </button>
            <button class="btn btn-primary" t-on-click="openLast7DaysOrders"> New Projects </button>
            <button class="btn btn-primary" t-on-click="openLast7DaysCancelledOrders"> Cancelled Projects </button>
            <select style="width:100px" class="form-select" t-model="state.type" t-on-change="onChangeType">
                <option value="summary">Summary</option>
                <option value="contracting">Contracting</option>
                <option value="cash">Cash</option>
                <option value="acceptance">Acceptance</option>
                <option value="margin_income">Margin</option>
                <option value="margin3_income">Margin3</option>
            </select>
            <select style="width:100px" class="form-select" t-model="state.period" t-on-change="onChangePeriod">
                <option value="Y">Year</option>
                <option value="Q1">Q1</option>
                <option value="Q2">Q2</option>
                <option value="Q3">Q3</option>
                <option value="Q4">Q4</option>
            </select>
        </t>
    </Layout>

<!--    <div class="p-3">-->
<!--        <Counter class="mt-3"/>-->
<!--        <Card>-->
<!--            <t t-set-slot="title">My card</t>-->
<!--            Some quick example text...-->
<!--        </Card>-->
<!--        <TodoList/>-->
<!--    </div>-->

<!--    <t t-call="project_budget.clientaction.statistics"/>-->

    <div class="m-3 container">
        <t t-foreach="statistics['plans_data']" t-as="office" t-key="office">
            <div class="row">
                <t t-foreach="statistics['plans_data'][office]['summary']" t-as="type" t-key="type">
                    <t t-if="state.period == 'Y'">
                        <Card className="'w-25'">
                            <t t-set-slot="title" t-esc="office + ' ' + type + ' ' + ' ' + statistics['year'] + state.period"/>
                            <PieChart data="statistics['plans_data'][office]" period="state.period" type="state.type"/>
        <!--                    <h4 style="width: 100%; height: 40px; position: absolute; top: 50%; left: 0; margin-top: 0px; line-height: 6px; text-align: center; z-index: 999999999999999">-->
        <!--                        <t t-esc="statistics['plan_q1'][3]"/>-->
        <!--                    </h4>-->
                            <t t-set-slot="legend" t-esc="'Plan: ' + statistics['plans_data'][office]['summary'][type][0][0] + '  Fact: ' + statistics['plans_data'][office]['summary'][type][0][1]"/>
                        </Card>
                    </t>
                </t>
            </div>
        </t>
    </div>
<!--    <div class="m-3 container">-->
<!--        <div class="row">-->
<!--            <Card className="'w-25'">-->
<!--                <t t-set-slot="title">Q1 Contracting</t>-->
<!--                <BarChart data="statistics['kam_plan_q1']"/>-->
<!--            </Card>-->
<!--            <Card className="'w-25'">-->
<!--                <t t-set-slot="title">Q2 Contracting</t>-->
<!--                <BarChart data="statistics['kam_plan_q2']"/>-->
<!--            </Card>-->
<!--            <Card className="'w-25'">-->
<!--                <t t-set-slot="title">Q3 Contracting</t>-->
<!--                <BarChart data="statistics['kam_plan_q3']"/>-->
<!--            </Card>-->
<!--            <Card className="'w-25'">-->
<!--                <t t-set-slot="title">Q4 Contracting</t>-->
<!--                <BarChart data="statistics['kam_plan_q4']"/>-->
<!--            </Card>-->
<!--         </div>-->
<!--    </div>-->
</t>

<t t-name="project_budget.clientaction.statistics" owl="1">
    <div class="d-flex flex-nowrap">
        <div t-foreach="keyToString" t-as="key" t-key="key" class="m-2">
            <Card>
                <t t-set-slot="title"><t t-esc="keyToString[key]"/></t>
                <p class="card-text"><t t-esc="statistics[key]"/></p>
            </Card>
        </div>
    </div>
</t>

</templates>
